ggplot(aapl_scaled %>% filter(date >= date("2010-01-01"), date < date("2010-06-30")), aes(x = date, y = score)) + geom_line()
ggplot(aapl %>% filter(date >= date("2010-01-01"), date < date("2010-06-30")), aes(x = date, y = score)) + geom_line()
ggplot(aapl %>% filter(date >= date("2010-01-01"), date < date("2010-12-30")), aes(x = date, y = score)) + geom_line()
ggplot(aapl_scaled %>% filter(date >= date("2010-01-01"), date < date("2010-12-30")), aes(x = date, y = score)) + geom_line()
aapl_2010 <- scale_trends(filter(aapl, date >= date("2010-01-01"), date < date("2010-12-30")))
ggplot(aapl_2010 %>% filter(date >= date("2010-01-01"), date < date("2010-12-30")), aes(x = date, y = score)) + geom_line()
ggplot(aapl_2010 %>% filter(date >= date("2010-01-01"), date < date("2010-12-30")), aes(x = date, y = score)) + geom_line()
aapl_2010 <- scale_trends(filter(aapl, date >= date("2010-01-01"), date < date("2010-12-25")))
ggplot(aapl_2010 %>% filter(date >= date("2010-01-01"), date < date("2010-12-30")), aes(x = date, y = score)) + geom_line()
devtools::load_all(".")
scale_trends(aapl)
aapl_1 <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("2010-01-01", "2010-02-10"))
aapl_1 <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("2010-02-01", "2010-02-28"))
aapl_1 <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("2010-01-01", "2010-02-10"))
aapl_2 <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("2010-02-01", "2010-02-28"))
aapl_1
aapl_2
aapl_2$chunk <- 2
aapl_2
aapl_1[20:29,]
aapl_1[30:39,]
aapl_1[32:41,]
aapl_1[32:41,]
aapl_2
aapl_2[1:10,]
aapl_1[32:41,]
aapl_2[1:10,]
aapl_1[32:41,] -> o1
aapl_2[1:10,] -> o2
o1$score / o2$score
o1$score / o2$score %>% mean
(o1$score / o2$score) %>% mean
?mean
devtools::load_all(".")
scale_trends(aapl)
aapl %>% filter(date == 1277856000)
aapl_test <- dplyr::bind_rows(aapl_1, aapl_2)
scale_trends(aapl_test)
?dplyr::pull
devtools::load_all(".")
scale_trends(aapl_test)
scale_trends(aapl_test)$score
ggplot(aapl_test, aes(x = date, y = score)) + geom_point()
ggplot(scale_trends(aapl_test), aes(x = date, y = score)) + geom_point()
ggplot(scale_trends(aapl_test), aes(x = date, y = score)) + geom_line()
scale_trends(aapl_test)$score
ggplot(scale_trends(aapl_test), aes(x = date, y = score)) + geom_point()
scale_trends(aapl_test) %>% filter(date %in% interval("2010-02-01", "2010-02-10"))
scale_trends(aapl_test) %>% filter(date %in% interval("20100201", "20100210"))
scale_trends(aapl_test) %>% filter(date > date("20100201"))
scale_trends(aapl_test) %>% filter(date > date("2010-02-01"))
scale_trends(aapl_test) %>% filter(date > date("2010-02-01"))
scale_trends(aapl_test) %>% filter(date > date("2010-02-01")) %>% print(n = 20)
devtools::load_all(".")
aapl_over <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))
aapl_over_scaled <- scale_trends(aapl_over)
ggplot(scale_trends(aapl_over_scaled), aes(x = date, y = score)) + geom_point()
ggplot(aapl_over_scaled, aes(x = date, y = score)) + geom_point()
devtools::load_all(".")
aapl_over <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))
aapl_over <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))
rlang::last_error()
devtools::load_all(".")
rlang::last_error()
aapl_over <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))
devtools::load_all(".")
aapl_over <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))
devtools::load_all(".")
aapl_over <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))
devtools::load_all(".")
aapl_over <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))
devtools::load_all(".")
aapl_over <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))
devtools::load_all(".")
aapl_over <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))#
aapl_over_scaled <- scale_trends(aapl_over)
ggplot(aapl_over_scaled, aes(x = date, y = score)) + geom_point()
devtools::load_all(".")
aapl_over_scaled <- scale_trends(aapl_over)
aapl_scaled
aapl_over_scaled
devtools::load_all(".")
aapl <- download_trends("AAPL", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))
aapl_scaled <- scale_trends(aapl)
ggplot(aapl_scaled, aes(x = date, y = score)) + geom_point()
tsla <- download_trends("TSLA", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))
devtools::load_all(".")
tsla <- download_trends("TSLA", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))
rlang::last_error()
devtools::load_all(".")
tsla <- download_trends("TSLA", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))
devtools::load_all(".")
tsla <- download_trends("TSLA", c(ticker = "{TICKER}"), int = interval("20100101", "20221231"))
tsla <- download_trends("TSLA", int = interval("20100101", "20221231"))
devtools::load_all(".")
tsla <- download_trends("TSLA", int = interval("20100101", "20221231"))
ggplot(tsla, aes(x = date, y = score)) + geom_point()
tsla_scaled <- scale_trends(tsla)
devtools::load_all(".")
tsla_scaled <- scale_trends(tsla)
?mean
mean(Inf)
mean(Inf, 1)
mean(c(1, Inf, 3))
1/Inf
devtools::load_all(".")
tsla_scaled <- scale_trends(tsla)
devtools::load_all(".")
tsla_scaled <- scale_trends(tsla)
devtools::load_all(".")
tsla_scaled <- scale_trends(tsla)
0 / 0
mean(NaN, na.rm = T)
mean(NaN, 1, na.rm = T)
mean(c(NaN, 1) , na.rm = T)
mean(c(NaN, 1, 2) , na.rm = T)
mean(c(NaN, 1, 2) , na.rm = F)
devtools::load_all(".")
tsla_scaled <- scale_trends(tsla)
devtools::load_all(".")
tsla_scaled <- scale_trends(tsla)
ggplot(tsla_scaled, aes(x = date, y = score)) + geom_line()
ggplot(tsla_scaled, aes(x = date, y = score)) + geom_point()
aapl_stock <- download_trends("AAPL stock", int = interval("20100101", "20221231"))
aapl_stock <- download_trends("AAPL stock", int = interval("20040101", "20221231"))
ggplot(aapl_stock, aes(x = date, y = score)) + geom_point()
ggplot(scale_trends(aapl_stock), aes(x = date, y = score)) + geom_point()
gc()
ggplot(aapl_stock, aes(x = date, y = score)) + geom_point()
ggplot(scale_trends(aapl_stock), aes(x = date, y = score)) + geom_point()
ie <- download_trends("internet explorer", int = interval("20040101", "20221231"))
ggplot(scale_trends(ie), aes(x = date, y = score)) + geom_point()
ggplot(ie, aes(x = date, y = score)) + geom_point()
ggplot(scale_trends(ie), aes(x = date, y = score)) + geom_point()
devtools::load_all(".")
ggplot(scale_trends(ie), aes(x = date, y = score)) + geom_point()
aapl_scaled
length(unique(aapl_scaled$date))
?grep
?substr
devtools::load_all(".")
ggplot(aapl_scaled, aes(x = date, y = score)) + geom_point()
ggplot(aapl, aes(x = date, y = score)) + geom_point()
ggplot(tsla, aes(x = date, y = score)) + geom_point()
ggplot(ie, aes(x = date, y = score)) + geom_point()
?progress_bar
devtools::load_all(".")
download_trends("AAPL")
download_trends(c("AAPL", "MSFT", "TSLA"), int = interval("20200101", "20221231"))
rlang::last_error()
devtools::load_all(".")
devtools::load_all(".")
download_trends(c("AAPL", "MSFT", "TSLA"), int = interval("20200101", "20221231"))
?progress_bar
download_trends(c("AAPL", "MSFT", "TSLA"), int = interval("20200101", "20221231"))
devtools::load_all(".")
download_trends(c("AAPL", "MSFT", "TSLA"), int = interval("20200101", "20221231"))
devtools::load_all(".")
download_trends(c("AAPL", "MSFT", "TSLA"), interval("2004-01-01", "2022-12-31"))
library(lubridate)
download_trends(c("AAPL", "MSFT", "TSLA"), interval("2004-01-01", "2022-12-31"))
devtools::load_all(".")
knitr::opts_chunk$set(echo = TRUE)
library(purrr)
library(lubridate)
?system.file
library(readxl)
install.packages("readxl")
library(readxl)
read_xlsx("./inst/extdata/russell_3000/R3000_2023.xlsx")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(stringr)
library(readr)
years <- 2004:2023
for (year in years) {
read_xlsx(
path = paste0("./../inst/extdata/russell_3000/R3000_", year, ".xlsx")
) %>%
select(ticker = Ticker, name = Name) %>%
mutate(ticker = str_extract(ticker, "^\\w+")) %>%
write_csv(
file = paste0("./../inst/extdata/russell_3000/members_", year, ".csv")
)
}
read_csv("./inst/extdata/russell_3000/members_2004.csv")
read_csv("./inst/extdata/russell_3000/members_2004.csv") -> x
filter(x, ticker == "AAPL")
filter(x, ticker == "MSFT")
filter(x, ticker == "AMAN")
filter(x, ticker == "AMAZ")
filter(x, ticker == "AMZN")
filter(x, ticker == "GE")
filter(x, ticker == "NYSE")
filter(x, ticker == "NY")
filter(x, ticker == "KO")
filter(x, ticker == "PEPs")
filter(x, ticker == "PEPS")
filter(x, ticker == "PEP")
filter(x, ticker == "BR")
filter(x, ticker == "BRA")
filter(x, ticker == "BRO")
filter(x, ticker == "JJ")
filter(x, ticker == "JOHN")
filter(x, ticker == "JNJ")
filter(x, ticker == "PFI")
filter(x, ticker == "PFIZ")
filter(x, ticker == "PFZ")
filter(x, ticker == "PFZR")
filter(x, ticker == "BROW")
x
x$ticker
x$ticker[]
x$ticker[2]
str_detect(x, "\\d")
str_detect(x$ticker, "\\d")
str_detect(x$ticker, "\\d") %>% sum
devtools::load_all(".")
library(readr)
library(readxl)
library(dplyr)
library(stringr)
years <- 2004:2023
for (year in years) {
read_xlsx(
path = paste0("./../inst/extdata/russell_3000/R3000_", year, ".xlsx")
) %>%
select(ticker = Ticker, name = Name) %>%
mutate(ticker = str_extract(ticker, "^\\w+")) %>%
filter(!str_detect(ticker, "\\d")) %>%
write_csv(
file = paste0("./../inst/extdata/russell_3000/members_", year, ".csv")
)
}
x <- read_csv("./inst/extdata/russell_3000/members_2023.csv")
x
x <- read_csv("./inst/extdata/russell_3000/members_2004.csv")
x
read_csv("./inst/extdata/russell_3000/members_2004.csv") -> x_2004
read_csv("./inst/extdata/russell_3000/members_2023.csv") -> x_2023
intersect(x_2004$ticker, x_2023$ticker)
intersect(x_2004$ticker, x_2023$ticker) %>% length()
library(GTrendsStocks)
russell
devtools::load_all(".")
russell_3000()
devtools::load_all(".")
devtools::load_all(".")
russell_3000()
russell_3000(2004)
russell_3000(2005)
russell_3000(2006)
russell_3000(2007)
russell_3000(2008)
russell_3000(2009)
russell_3000(2010)
russell_3000(2011)
knitr::opts_chunk$set(echo = TRUE)
library(progress)
library(purrr)
library(lubridate)
library(progress)
pb <- progress::progress_bar$new(
total = length(russell_3000()),
format = "Downloading :what [:bar] :current/:total"
)
walk(russell_3000(), function(ticker) {
pb$tick()
trends <- download_trends(ticker, interval("2004-01-01", "2022-12-31")) %>%
scale_trends() %>%
save_trends(ticker, basedir = "./../trends")
})
?write_rds
devtools::load_all(".")
library(purrr)
library(lubridate)
library(progress)
pb <- progress::progress_bar$new(
total = length(russell_3000()),
format = "Downloading :what [:bar] :current/:total"
)
walk(russell_3000(), function(ticker) {
pb$tick()
trends <- download_trends(ticker, interval("2004-01-01", "2022-12-31")) %>%
scale_trends() %>%
save_trends(ticker, basedir = "./../trends")
})
library(purrr)
library(lubridate)
library(progress)
pb <- progress::progress_bar$new(
total = length(russell_3000()),
format = "Downloading :what [:bar] :current/:total"
)
walk(russell_3000()$ticker, function(ticker) {
pb$tick()
trends <- download_trends(ticker, interval("2004-01-01", "2022-12-31")) %>%
scale_trends() %>%
save_trends(ticker, basedir = "./../trends")
})
library(purrr)
library(lubridate)
library(progress)
pb <- progress::progress_bar$new(
total = nrow(russell_3000()),
format = "Downloading :what [:bar] :current/:total"
)
walk(russell_3000()$ticker, function(ticker) {
pb$tick()
trends <- download_trends(ticker, interval("2004-01-01", "2022-12-31")) %>%
scale_trends() %>%
save_trends(ticker, basedir = "./../trends")
})
devtools::load_all(".")
devtools::load_all(".")
library(purrr)
library(lubridate)
library(progress)
pb <- progress::progress_bar$new(
total = nrow(russell_3000()),
format = "Downloading :what [:bar] :current/:total"
)
walk(russell_3000()$ticker, function(ticker) {
pb$tick()
trends <- download_trends(ticker, interval("2004-01-01", "2022-12-31")) %>%
scale_trends() %>%
save_trends(ticker, basedir = "./../trends")
})
AA <- readRDS("~/David/R_Playground/GTrendsStocks/trends/A/AA.rds")
AA
library(ggplot)
library(ggplot2)
ggplot(AA, aes(x = date, y = score)) + geom_point()
?median
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(readxl)
library(dplyr)
library(stringr)
years <- 2004:2023
for (year in years) {
read_xlsx(
path = paste0("./../inst/extdata/sp_500/SPX_", year, ".xlsx")
) %>%
select(ticker = Ticker, name = Name) %>%
mutate(ticker = str_extract(ticker, "^\\w+")) %>%
filter(!str_detect(ticker, "\\d")) %>%
write_csv(
file = paste0("./../inst/extdata/sp_500/members_", year, ".csv")
)
}
library(purrr)
sp500 <- map_dfr(years, function(year) {
read_csv(file = paste0("./../inst/extdata/sp_500/members_", year, ".csv")) %>%
mutate(year = year)
})
sp500
unique(sp500$ticker)
sp500 <- map_dfr(years, function(year) {
read_csv(
file = paste0("./../inst/extdata/sp_500/members_", year, ".csv")
) %>%
supressMessages() %>%
mutate(year = year)
}) %>%
group_by(ticker) %>%
summarise(first_year = min(year), last_year = max(year))
sp500 <- map_dfr(years, function(year) {
read_csv(
file = paste0("./../inst/extdata/sp_500/members_", year, ".csv")
) %>%
suppressMessages() %>%
mutate(year = year)
}) %>%
group_by(ticker) %>%
summarise(first_year = min(year), last_year = max(year))
sp500
write_csv(sp500, "./inst/extdata/sp_500/sp_500.csv")
devtools::load_all(".")
library(GTrendsStocks)
devtools::load_all(".")
sp_500()
knitr::opts_chunk$set(echo = TRUE)
sp500 <- map_dfr(years, function(year) {
read_csv(
file = paste0("./../inst/extdata/sp_500/members_", year, ".csv")
) %>%
suppressMessages() %>%
mutate(year = year)
}) %>%
group_by(ticker, name) %>%
summarise(first_year = min(year), last_year = max(year))
sp500
write_csv(sp500, "./inst/extdata/sp_500/sp_500.csv")
library(GTrendsStocks)
devtools::load_all(".")
sp_500()
walk(LETTERS, function(x) dir.create(paste0("./trends/sp_500", x)))
walk(LETTERS, function(x) dir.create(paste0("./trends/sp_500/", x)))
?write_rds
walk(LETTERS, function(x) dir.create(paste0("./trends/sp_500_scaled/", x)))
knitr::opts_chunk$set(echo = TRUE)
library(purrr)
library(lubridate)
library(progress)
pb <- progress::progress_bar$new(
total = nrow(sp_500()),
format = "Downloading :what [:bar] :current/:total"
)
pwalk(sp_500(), function(ticker, name, first_year, last_year) {
pb$tick()
interval_start <- paste0(first_year, "-01-01")
interval_end <- paste0(last_year, "-12-31")
if (last_year == 2023) interval_end <- "2022-12-31"
trends <- download_trends(
ticker,
interval(interval_start, interval_end)
) %>%
save_trends(ticker, basedir = "./../trends/sp_500_raw")
scale_trends() %>%
save_trends(ticker, basedir = "./../trends/sp_500_scaled")
})
devtools::load_all(".")
?txtProgressBar
devtools::load_all(".")
library(purrr)
library(lubridate)
library(progress)
pb <- progress::progress_bar$new(
total = nrow(sp_500()),
format = "Downloading :what [:bar] :current/:total"
)
pwalk(sp_500(), function(ticker, name, first_year, last_year) {
pb$tick()
interval_start <- paste0(first_year, "-01-01")
interval_end <- paste0(last_year, "-12-31")
if (last_year == 2023) interval_end <- "2022-12-31"
trends <- download_trends(
keywords = paste(ticker, "STOCK"),
interval(interval_start, interval_end)
) %>%
save_trends(ticker, basedir = "./../trends/sp_500_raw") %>%
scale_trends() %>%
save_trends(ticker, basedir = "./../trends/sp_500_scaled")
})
library(purrr)
library(lubridate)
library(progress)
pb <- progress::progress_bar$new(
total = nrow(sp_500()),
format = "Downloading :ticker - :name [:bar] :current/:total"
)
pwalk(sp_500(), function(ticker, name, first_year, last_year) {
pb$tick(tokens = list(ticker = ticker, name = name))
interval_start <- paste0(first_year, "-01-01")
interval_end <- paste0(last_year, "-12-31")
if (last_year == 2023) interval_end <- "2022-12-31"
trends <- download_trends(
keywords = paste(ticker, "STOCK"),
interval(interval_start, interval_end)
) %>%
save_trends(ticker, basedir = "./../trends/sp_500_raw") %>%
scale_trends() %>%
save_trends(ticker, basedir = "./../trends/sp_500_scaled")
})
rlang::last_error()
sp_500()
sp_500()[12,]
pwalk(
sp_500() %>% filter(first_year < 2023, ticker > "ACAS"),
function(ticker, name, first_year, last_year
) {
pb$tick(tokens = list(ticker = ticker, name = name))
interval_start <- paste0(first_year, "-01-01")
interval_end <- paste0(last_year, "-12-31")
if (last_year == 2023) interval_end <- "2022-12-31"
trends <- download_trends(
keywords = paste(ticker, "STOCK"),
interval(interval_start, interval_end)
) %>%
save_trends(ticker, basedir = "./../trends/sp_500_raw") %>%
scale_trends() %>%
save_trends(ticker, basedir = "./../trends/sp_500_scaled")
})
pwalk(
sp_500() %>% filter(first_year < 2023, ticker > "AMZN"),
function(ticker, name, first_year, last_year
) {
pb$tick(tokens = list(ticker = ticker, name = name))
interval_start <- paste0(first_year, "-01-01")
interval_end <- paste0(last_year, "-12-31")
if (last_year == 2023) interval_end <- "2022-12-31"
trends <- download_trends(
keywords = paste(ticker, "STOCK"),
interval(interval_start, interval_end)
) %>%
save_trends(ticker, basedir = "./../trends/sp_500_raw") %>%
scale_trends() %>%
save_trends(ticker, basedir = "./../trends/sp_500_scaled")
})
gtrends("test")
gtrends("test")
gtrends("test")
devtools::load_all(".")
gtrends("test")
gtrends("test", onlyInterest = T)
library(gtrendsR)
gtrends("test", onlyInterest = T)
install.packages("devtools")
install.packages("gtrendsR")
install.packages("plotly")
library(GTrendsStocks)
